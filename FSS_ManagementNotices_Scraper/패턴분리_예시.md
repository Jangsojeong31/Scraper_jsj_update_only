# 패턴 분리 예시 분석

## 입력 패턴
```
가. 문책사항
  (1)
  (2)
  (가)
  (나)
  (3)
  (4)
나. 주의사항
  (1)
  (2)
  (3)
  (4)
  (5)
  (6)
  (7)
다.
라.
```

## 처리 과정 및 결과

### 1단계: "가. 문책사항" (467줄 패턴)
```
처리: header_pattern 매칭
결과:
  - parent_title = "문책사항"
  - current_title = None
  - in_incident = False
  - is_unified_incident = False
```
**상태:** "(1)"이 나올 때까지 대기

---

### 2단계: "(1)" (548줄 패턴)
```
처리: numbered_pattern 매칭
결과:
  - 이전 사건: 없음 (current_title = None)
  - current_title = "(1)의 제목" (접두사 없음, 특수 키워드라서)
  - in_incident = True
  - 사건 1 시작
```
**사건 1:** 제목 = "(1)의 제목", 내용 = []

---

### 3단계: "(2)" (548줄 패턴)
```
처리: numbered_pattern 매칭
결과:
  - 이전 사건 저장: 사건 1
  - current_title = "(2)의 제목"
  - 사건 2 시작
```
**사건 1:** 제목 = "(1)의 제목", 내용 = "(1)의 내용"
**사건 2:** 제목 = "(2)의 제목", 내용 = []

---

### 4단계: "(가)" (624줄 패턴)
```
처리: sub_item_pattern 매칭
결과:
  - in_incident = True, current_title 있음
  - 사건 2의 내용으로 추가
```
**사건 2:** 제목 = "(2)의 제목", 내용 = ["(가)의 내용"]

---

### 5단계: "(나)" (624줄 패턴)
```
처리: sub_item_pattern 매칭
결과:
  - 사건 2의 내용으로 추가
```
**사건 2:** 제목 = "(2)의 제목", 내용 = ["(가)의 내용", "(나)의 내용"]

---

### 6단계: "(3)" (548줄 패턴)
```
처리: numbered_pattern 매칭
결과:
  - 이전 사건 저장: 사건 2
  - current_title = "(3)의 제목"
  - 사건 3 시작
```
**사건 2:** 제목 = "(2)의 제목", 내용 = ["(가)의 내용", "(나)의 내용"]
**사건 3:** 제목 = "(3)의 제목", 내용 = []

---

### 7단계: "(4)" (548줄 패턴)
```
처리: numbered_pattern 매칭
결과:
  - 이전 사건 저장: 사건 3
  - current_title = "(4)의 제목"
  - 사건 4 시작
```
**사건 3:** 제목 = "(3)의 제목", 내용 = "(3)의 내용"
**사건 4:** 제목 = "(4)의 제목", 내용 = []

---

### 8단계: "나. 주의사항" (467줄 패턴)
```
처리: header_pattern 매칭
결과:
  - 이전 사건 저장: 사건 4
  - parent_title = "주의사항"
  - current_title = None
  - in_incident = False
```
**사건 4:** 제목 = "(4)의 제목", 내용 = "(4)의 내용"
**상태:** "(1)"이 나올 때까지 대기

---

### 9단계: "(1)" ~ "(7)" (548줄 패턴, 각각)
```
처리: numbered_pattern 매칭 (각각)
결과:
  - 각각 별도 사건으로 분리
  - 제목: "(1)의 제목", "(2)의 제목", ..., "(7)의 제목"
  - 접두사 없음 (특수 키워드 "주의사항"이라서)
```
**사건 5:** 제목 = "(1)의 제목", 내용 = "(1)의 내용"
**사건 6:** 제목 = "(2)의 제목", 내용 = "(2)의 내용"
**사건 7:** 제목 = "(3)의 제목", 내용 = "(3)의 내용"
**사건 8:** 제목 = "(4)의 제목", 내용 = "(4)의 내용"
**사건 9:** 제목 = "(5)의 제목", 내용 = "(5)의 내용"
**사건 10:** 제목 = "(6)의 제목", 내용 = "(6)의 내용"
**사건 11:** 제목 = "(7)의 제목", 내용 = "(7)의 내용"

---

### 10단계: "다." (492줄 패턴)
```
처리: first_type_pattern 매칭
조건: 특수 키워드 없음
결과:
  - 이전 사건 저장: 사건 11
  - parent_title = "다." 뒤 내용
  - current_title = "다." 뒤 내용 (즉시 사건 시작)
  - is_unified_incident = True (통합 모드!)
```
**사건 11:** 제목 = "(7)의 제목", 내용 = "(7)의 내용"
**사건 12:** 제목 = "다." 뒤 내용, 내용 = []

---

### 11단계: "라." (492줄 패턴)
```
처리: first_type_pattern 매칭
조건: 특수 키워드 없음
결과:
  - 이전 사건 저장: 사건 12
  - parent_title = "라." 뒤 내용
  - current_title = "라." 뒤 내용
  - is_unified_incident = True
```
**사건 12:** 제목 = "다." 뒤 내용, 내용 = "다.의 내용"
**사건 13:** 제목 = "라." 뒤 내용, 내용 = []

---

## 최종 결과 요약

### 총 사건 수: 13개

#### "가. 문책사항" 하위:
1. **사건 1:** 제목 = "(1)의 제목"
2. **사건 2:** 제목 = "(2)의 제목", 내용에 "(가)", "(나)" 포함
3. **사건 3:** 제목 = "(3)의 제목"
4. **사건 4:** 제목 = "(4)의 제목"

#### "나. 주의사항" 하위:
5. **사건 5:** 제목 = "(1)의 제목"
6. **사건 6:** 제목 = "(2)의 제목"
7. **사건 7:** 제목 = "(3)의 제목"
8. **사건 8:** 제목 = "(4)의 제목"
9. **사건 9:** 제목 = "(5)의 제목"
10. **사건 10:** 제목 = "(6)의 제목"
11. **사건 11:** 제목 = "(7)의 제목"

#### 기타:
12. **사건 12:** 제목 = "다." 뒤 내용 (통합 모드)
13. **사건 13:** 제목 = "라." 뒤 내용 (통합 모드)

---

## 핵심 포인트

1. **"(가)", "(나)"는 사건 제목이 아니라 내용으로 처리됨**
   - 624줄 sub_item_pattern이 매칭
   - 현재 사건의 내용에 추가

2. **"(3)", "(4)"는 "(2)"와 별도 사건으로 분리됨**
   - 548줄 numbered_pattern이 매칭
   - 각각 새 사건 시작

3. **"나. 주의사항"은 특수 키워드로 인식**
   - 467줄 header_pattern 매칭
   - 각 "(1)" ~ "(7)"을 별도 사건으로 처리

4. **"다.", "라."는 통합 모드로 처리**
   - 특수 키워드 없음
   - is_unified_incident = True
   - 만약 "(1)", "(2)"가 나오면 모두 내용으로 추가됨

