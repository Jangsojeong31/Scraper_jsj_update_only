#!/usr/bin/env python
# -*- coding: utf-8 -*-
"""페이지 번호 제거 및 사건 분리 테스트"""

import sys
sys.path.insert(0, '.')
from extract_metadata import remove_page_numbers, _extract_incidents_from_section

# 테스트 텍스트
test_text = """4. 조치대상사실
가. 경영유의사항
(1) PF대출 취급 및 조건변경 관련 리스크관리 강화
① PF대출의 조건 변경 심사 강화
저축은행은 旣 취급한 PF대출의 중요사항이 변경되어 대출조건이 당초 승인내용보다 악화되는 경우에는 여신심사위원회 및 이사회의 승인을 득해야 하여야 함에도旣 취급한 PF대출의 대출조건이 당초 승인내용 보다 악화되는 경우에대한세부적인 기준을 마련하지 않았고, 2024년 3분기 ~ 2025년 2분기 기간 중 旣 취급한PF대출(브릿지대출 포함)의 조건 변경 시 대출조건 악화 가능성 등을 검토하지않고이사회 승인 없이 여심심사위원회 승인으로만 진행하였는바
앞으로 중요사항이 변경되어 대출조건이 당초 승인내용 보다 악화되는 경우에대한 세부적인 기준을 마련하고, 실제 대출조건이 악화되는 경우 이사회의 승인을받도록 운영하는 등 PF대출 조건 변경 심사를 강화할 필요가 있음
② PF대출 취급･관리 강화
저축은행은 형식상 수분양자 중도금․잔금대출이어도 사실상 부동산개발관련기성고 대출인 경우에는 PF대출에 해당되어 PF대출 기준 사업타당성 검토등을하여야 함에도
- 2 -
생활형숙박시설 수분양자들에 대해 공사비 지원 등의 목적으로 신용대출을취급하면서 해당 대출을 일반대출로 분류하여 자기자본 20% 충족 여부 및외부기관에 의한 사업타당성을 검토하지 않고, 대출 취급 이후에도 사업성평가 및PF
대출 대손충당금 적립 기준을 적용하지 않았는바,
앞으로 형식상 수분양자 중도금․잔금대출이어도 사실상 부동산개발관련기성고 대출인 경우에는 PF대출로 분류하여 PF대출 사업성 평가를 실시하고PF
대출 대손충당금 적립률을 적용할 필요가 있음
(2) 부동산 관련 업종 여신 편중리스크 관리 강화
저축은행은 여신업무를 처리함에 있어 산업별, 고객그룹별 여신운용의다양화를 통해 여신편중 현상을 방지하여야 하고, 특정 부분에의 과도한위험집중을 방지하기 위하여 위험을 적절하게 분산하여야 함에도
2025년 6월말 현재 PF대출 및 건설업 등 부동산업 관련 대출액이 총여신의44.3%를 차지하는 등 부동산 부문에 여신이 편중되어 있어 향후 부동산 경기침체시자산건전성이 크게 악화될 우려가 있는바
앞으로 자산건전성의 안정적 유지를 위해 부동산업 등 특정 업종에 대한 여신이편중되지 않도록 대출 유형별 총량 및 증가율을 적정한 수준으로 관리하고여신포트폴리오를 다양화하는 등 여신편중 리스크관리 방안을 마련할 필요가있음(3) 자본적정성 관리업무 강화
2025년 6월말 현재 BIS기준자기자본비율은 14.64%로 동류그룹(’25.6말 기준 자산3,000 ~ 3,500억원 5개사) 평균(18.47%) 대비 낮고, BIS기준기본자본비율은 7.96%로동류그룹 중 최하위이며, 기본자본 대비 보완자본 비중(83.9%) 및 총자산 대비 위험가중치100% 자산 비중(85.5%)도 동료그룹 평균(각각 10.3% 및 77.1%) 대비 높은 상황임에도’23 ~ ’24년 2년 연속 동일 유형자산(토지)에 대한 재평가를 실시하여 실제자금유입 없는 재평가이익을 통해 자본을 조달하는 등 자본확충 수단이 적정하지 못하고,
BIS기준자기자본비율 및 위험가중자산의 변동 요인에 대한 분석 및 변동 가능성에대한 대응 방안을 검토하지 않는 등 자본적정성 관리를 소홀히 하고 있는바
- 3 -
앞으로 수익 안정화 등 합리적인 자본확충 수단을 마련하고, BIS기준자기자본비율, 위험가중자산의 추이 및 변동 요인에 대한 분석 및 대응 방안을 검토하는등자본적정성 관리를 철저히 할 필요가 있음
(4) 유동성리스크 관리 강화
저축은행은 예상치 못한 자금의 수요 및 공급에 대응하지 못함에 따라발생하는 유동성리스크를 적절하게 분산하고, 위기상황 판단지표 중 1개 이상 항목이위기상황 판단기준에 해당될 경우 해당 지표의 악화 원인 및 영향 등에 대한분석보고서를 작성하여 대표이사에게 보고하여야 함에도
특정 시기 유동성부채(예수금) 집중 등 유동성비율의 기간별 편차가 커 유동성리스크의 적절한 분산 및 관리가 미흡하고, 위기상황 판단지표 중 유동성비율 항목이위기상황 판단기준에 해당됨에도 해당 지표의 악화 원인 및 영향 등에 대한분석보고서를 작성하지 않았는바
앞으로 수신상품 만기 평탄화 등 유동성비율을 평준화하여 유동성리스크가적절히 분산될 수 있도록 운영하고, 위기상황 판단지표 중 1개 이상 항목이위기상황 판단기준에 해당될 경우 해당 지표의 악화 원인 및 영향 등에 대한분석보고서를 작성하는 등 유동성리스크 관련 위기상황 대응체계를 개선할 필요가 있음(5) 유가증권 투자업무 관련 리스크 관리 강화
저축은행은 유가증권 등을 매입할 경우 유가증권 투자협의회* 및 이사회심의‧의결 후 대표이사에게 보고하여야 함에도
* 유가증권 투자 전략･규모･투자대상 선정･한도초과 및 손절매 유보 등의 사항을 심의･의결검사대상 기간 중 42개 상장주식 및 1개 ETF를 한국거래소를 통해 매매하면서유가증권 투자협의회 및 이사회 심의‧의결 없이 대표이사 전결로만 진행하여유가증권 투자 시 적정한 투자규모를 산정하고 가격변동 등의 위험을 예방하여투자리스크를 최소화하는 등 안정적인 자산 운용을 하지 않았는바
앞으로 유가증권 투자협의회를 개최하여 유가증권 투자 전략･규모･투자대상선정･한도초과 및 손절매 유보 등의 사항을 심의･의결 등 유가증권 투자업무에대한 관리를 강화할 필요가 있음
- 4 -
(6) 정보보호최고책임자 자격기준 등 지정절차 강화
저축은행은 정보기술 보안을 총괄하는 정보보호책임자를 지정하여야하며,
해당 정보보호책임자는 전자금융거래법령상 일정한 자격요건*을 갖추어야 함에도* 정보보호 분야의 학사(전문학사)학위를 취득한 후 2년(4년) 이상 정보보호 분야 업무를 수행한경력이 있는 사람 등(「전자금융거래법시행령」제11조의3 제4항 [별표1] 참조)
검사착수일(‘25.9.25.) 현재 정보보호책임자로 지정된 여신팀 팀장은 전자금융거래법령상 정보보호최고책임자의 자격요건을 갖추지 못한 것으로 확인되는바앞으로 전자금융거래법령상 정보보호최고책임자 자격요건을 갖춘 자를정보보호최고책임자로 지정할 필요가 있음
(7) 사업계획 목표수립 및 평가체계 강화
저축은행은 효율적인 경영을 위해 기본 사업계획뿐만 아니라 중‧장기적인사업계획 목표를 수립하고 동 목표를 주기적으로 평가하여 사업계획을 수정·보완하여야 함에도
사업계획 수립 시 1년 단위의 예상 손익, 예수금·대출금계획, 예상 BIS비율을포함한 영업목표만 설정하고 중‧장기적인 사업계획 목표를 설정하지 않았고, 매년도사업계획 수립 시 전년도 사업계획 목표 대비 실적을 평가하지 않는 등사업목표 달성을 위한 평가를 소홀히 한 사실이 확인되는바
앞으로 사업계획 수립 시 1년 단위의 목표 외에 중·장기적인 사업 목표를수립하고, 직전년도 사업계획 목표 대비 실적에 대한 평가체계를 강화하여안정적이고 장기적인 사업계획 목표관리가 이루어지도록 운영할 필요가 있음(8) 감정평가법인 및 법무사 지정업무 등 직무분리 강화
저축은행은 직무분리가 필요한 필수직무를 관련 내규에 명시하도록 하면서그예시로 감정평가사 및 법무사 지정업무를 여신심사의 후선업무로 분류하였음에도감정평가법인 및 법무사 지정업무 분장이 관련 내규에 반영되어 있지않고여신팀에서 해당 업무를 담당하고 있어 직무분리가 이루어지지 않은 상황인바
- 5 -
앞으로 감정평가법인 및 법무사 지정업무 분장을 관련 내규에 반영하고해당업무를 여신팀이 아닌 여신심사 후선부서에서 담당하도록 하는 등 직무분리를강화할 필요가 있음
(9) 비업무용부동산 처분업무 강화
저축은행은 단시일내에 유입물건 처분이 종료될 수 있도록 매분기 1회이상공매를 실시하여야 하고, 제2차 공매예정가액은 제1차 공매예정가액의 10% 이상씩인하하여 책정함을 원칙으로 하며, 해당 물건 취득일로부터 5년이 경과할 때까지매매계약이 체결되지 않은 경우 한국자산관리공사에 매각을 위임하여야 함에도2017년 대출채권 정리 등으로 인수한 비업무용부동산 37개에 대해 매분기1회공매를 실시하면서 공매예정가액을 직전 분기 공매가액과 동일하게 설정하거나해당 물건을 취득한지 5년이 경과하였음에도 한국자산관리공사에 매각을 위임하지않는 등 비업무용 부동산 정리가 지연되고 있는 상황인바
앞으로 비업무용 부동산 보유 장기화에 따른 수익성 및 유동성 저하를방지하기 위해 구체적인 매각방안을 마련하는 등 처분업무 관리를 강화할 필요가있음나. 개선사항
(1) 이사회 및 각종 위원회 운영 실효성 제고
① 이사회의 형식적 운영
상호저축은행의 이사회는 회사의 업무집행에 관한 의사결정을 하고대표이사를 비롯한 이사의 직무집행을 감독하는 기능을 담당하며, 이사는 법령과정관의 규정에 따라 회사 및 주주를 위하여 그 직무를 충실하게 수행하여야 함에도2024.1.1. ~ 검사착수일(’25.9.25.) 현재까지 기타비상무이사 A는 이사회에 출석한사실이 없고, 기타비상무이사 B, C 및 사외이사 D는 이사회에 출석하여 심의‧
의결한 것으로 의사록에 기재되어 있으나 실제로 이사회에 출석하여 심의‧의결한사실이 없는 것으로 확인되는바
앞으로 회사의 업무집행 의사결정 및 대표이사 등의 직무집행 감독이라는본연의 기능이 충실히 실현될 수 있도록 이사회를 실질적으로 운영할 필요가있음
- 6 -
② 여신심사위원회의 여신심사 기능 미흡
저축은행은 여신의 건전성 확보 등을 위하여 여신심사위원회를 설치‧운영하여야 하며, 여신심사위원회를 운영하는 과정에서 심사 기능의 독립성 및준법감시 기능 등이 보장되어야 함에도
여신심사위원회 심사위원(여신팀장, 중앙지점장, 경영지원부 본부장) 중 여신팀장,
중앙지점장은 영업책임자로서 본인이 부의한 안건에 대해 심의‧의결을 하고있어심사 기능의 독립성이 훼손될 염려가 있고, 심사위원 중 경영지원부 본부장이준법감시인을 겸직하고 있어 심사 과정에서의 준법감시 기능이 저하될 우려가 있는바앞으로 영업책임자 의결권 제한, 독립된 준법감시인 참관 등 여신심사기능의 독립성을 보장하고 심사 과정에서의 법규위반 여부에 대한 감시를강화하는 등 여시심사위원회의 실질적 운영을 위한 체계를 마련할 필요가 있음(2) 내부규정 및 조직 정비를 통한 업무 효율성 제고
① 내부규정의 부재 및 최신화 미비
저축은행은 ｢이사회 규정｣을 제정하지 않고 있고, 내부규정 총 54개중23개가 2000년 이전에 제‧개정되었음에도 현재까지 개정하지 않고 있으며, 저축은행중앙회 표준규정을 내규화 하지 않은 채 그대로 준용하고 있는바
앞으로 ｢이사회 규정｣ 등 필수 내부규정 제정 및 사문화된 내부규정을 최신화하고, 저축은행중앙회 표준규정을 내규화 한 후 내부규정과 통합하여 체계화된규정집을 마련할 필요가 있음
② 업무조직 부재 및 조직도 공시 미흡
저축은행은 여신 심사 및 사후관리에 관한 감리업무를 담당하는 직원이 있으나해당 업무를 담당하는 별도 부서를 마련하지 않았으며, 외부에 공시되는 조직도상조직운영과 실제 조직 운영 간의 불일치가 발생하고 있는바
앞으로 여신 심사 및 사후관리에 관한 감리업무 담당 부서를 마련하는등조직을 정비하고, 실제 운영되는 업무조직을 외부에 공시되는 조직도에 반영할필요가 있음
- 7 -
(3) 금리산정체계 개선
저축은행은 개인신용대출의 금리 산정시 차주의 신용평가 결과 및 대출금리구성요소별 세부기준 등 합리적인 대출금리 산정기준을 마련하여 운영하여야하며,
대출금리 요소 중 신용원가는 차주의 예상 불량률 및 손실률 등을 감안하여합리적으로 산정하고 차주의 신용상태를 반영하여 차등을 두어야 함에도
신용원가를 별도로 산정하지 않은 채 구체적인 기준 없이 담당자가 차주의신용도, 소득 등을 감안하여 최종 대출금리를 결정하고 있어, 기본금리(기준금리+
가산금리)가 동일함에도 신용도가 낮은 차주의 최종 대출금리가 신용도가 높은차주보다 낮은 사례가 확인되는 등 대출금리 산정체계에 불합리한 부분이 존재하는바앞으로 최종 대출금리 결정 시 기본금리 변동 및 차주의 신용도, 소득, 재산및 과거 이력 등을 감안하는 구체적인 기준을 마련･운영하는 등 대출금리산정체계를 합리적으로 개선할 필요가 있음"""

print('=' * 80)
print('1. 페이지 번호 제거 테스트')
print('=' * 80)
cleaned_text = remove_page_numbers(test_text)

# 페이지 번호가 제거되었는지 확인
if '- 2 -' in cleaned_text or '- 3 -' in cleaned_text or '- 4 -' in cleaned_text or '- 5 -' in cleaned_text or '- 6 -' in cleaned_text or '- 7 -' in cleaned_text:
    print('❌ 페이지 번호가 제거되지 않았습니다!')
    for i in range(2, 8):
        if f'- {i} -' in cleaned_text:
            print(f'  발견: - {i} -')
else:
    print('✓ 페이지 번호가 모두 제거되었습니다')

# - 7 - 다음에 (3)이 있는지 확인
if '- 7 -' in test_text:
    print('\n원본 텍스트에서 - 7 - 위치 확인:')
    idx = test_text.find('- 7 -')
    print(f'  위치: {idx}')
    print(f'  주변 텍스트: ...{test_text[idx-50:idx+100]}...')

if '- 7 -' not in cleaned_text:
    print('\n페이지 번호 제거 후 - 7 - 다음 확인:')
    # - 7 - 다음에 (3)이 있는지 확인
    idx_before = test_text.find('- 7 -')
    if idx_before != -1:
        after_text = test_text[idx_before+10:]  # - 7 - 다음
        cleaned_after = remove_page_numbers(after_text)
        if '(3) 금리산정체계 개선' in cleaned_after:
            print('  ✓ (3) 금리산정체계 개선이 발견됨')
            lines = cleaned_after.split('\n')
            for i, line in enumerate(lines[:5]):
                print(f'  줄 {i}: {line[:80]}')
        else:
            print('  ❌ (3) 금리산정체계 개선이 발견되지 않음')

print('\n' + '=' * 80)
print('2. 사건 분리 테스트')
print('=' * 80)
incidents = _extract_incidents_from_section(cleaned_text)
num_incidents = len([k for k in incidents if k.startswith('제목')])
print(f'총 {num_incidents}개 사건 추출됨')

print('\n추출된 사건 목록:')
for i in range(1, num_incidents + 1):
    title_key = f'제목{i}'
    if title_key in incidents:
        title = incidents[title_key]
        print(f'{i}. {title[:60]}...' if len(title) > 60 else f'{i}. {title}')

print('\n' + '=' * 80)
print('3. (3) 금리산정체계 개선 확인')
print('=' * 80)
found = False
for i in range(1, num_incidents + 1):
    title_key = f'제목{i}'
    if title_key in incidents:
        title = incidents[title_key]
        if '금리산정' in title or '금리산정체계' in title:
            print(f'✓ 발견: {title_key} = {title}')
            content_key = f'내용{i}'
            if content_key in incidents:
                content = incidents[content_key]
                print(f'  내용 길이: {len(content)}자')
                print(f'  내용 시작: {content[:150]}...')
            found = True
            break

if not found:
    print('❌ (3) 금리산정체계 개선이 별도 사건으로 분리되지 않았습니다!')
    print('\n마지막 사건 확인:')
    if num_incidents > 0:
        last_title_key = f'제목{num_incidents}'
        last_content_key = f'내용{num_incidents}'
        if last_title_key in incidents:
            print(f'  제목: {incidents[last_title_key]}')
        if last_content_key in incidents:
            content = incidents[last_content_key]
            if '(3)금리산정' in content or '(3) 금리산정' in content:
                print(f'  ❌ (3) 금리산정체계 개선이 이전 사건의 내용에 포함되어 있습니다!')
                print(f'  내용 일부: ...{content[-200:]}')

